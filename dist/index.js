var Yr=Object.create;var Pe=Object.defineProperty;var qr=Object.getOwnPropertyDescriptor;var Zr=Object.getOwnPropertyNames;var Jr=Object.getPrototypeOf,Wr=Object.prototype.hasOwnProperty;var q=(e,t)=>()=>(t||e((t={exports:{}}).exports,t),t.exports),Qr=(e,t)=>{for(var n in t)Pe(e,n,{get:t[n],enumerable:!0})},mt=(e,t,n,h)=>{if(t&&typeof t=="object"||typeof t=="function")for(let a of Zr(t))!Wr.call(e,a)&&a!==n&&Pe(e,a,{get:()=>t[a],enumerable:!(h=qr(t,a))||h.enumerable});return e};var Ft=(e,t,n)=>(n=e!=null?Yr(Jr(e)):{},mt(t||!e||!e.__esModule?Pe(n,"default",{value:e,enumerable:!0}):n,e)),Dr=e=>mt(Pe({},"__esModule",{value:!0}),e);var Vt=q((wi,We)=>{var ie="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function It(e){for(var t="",n=0,h=0,a=0,c=0,w=0,v=0,l=0,y=0;y<e.length;)n=e.charCodeAt(y++),c=n>>2,h=e.charCodeAt(y++),w=(n&3)<<4|h>>4,a=e.charCodeAt(y++),v=(h&15)<<2|a>>6,l=a&63,isNaN(h)?v=l=64:isNaN(a)&&(l=64),t+=ie.charAt(c)+ie.charAt(w)+ie.charAt(v)+ie.charAt(l);return t}function Nt(e){var t="",n=0,h=0,a=0,c=0,w=0,v=0,l=0;e=e.replace(/[^\w\+\/\=]/g,"");for(var y=0;y<e.length;)c=ie.indexOf(e.charAt(y++)),w=ie.indexOf(e.charAt(y++)),n=c<<2|w>>4,t+=String.fromCharCode(n),v=ie.indexOf(e.charAt(y++)),h=(w&15)<<4|v>>2,v!==64&&(t+=String.fromCharCode(h)),l=ie.indexOf(e.charAt(y++)),a=(v&3)<<6|l,l!==64&&(t+=String.fromCharCode(a));return t}var Z=function(){return typeof Buffer<"u"&&typeof process<"u"&&typeof process.versions<"u"&&!!process.versions.node}(),Qe=function(){if(typeof Buffer<"u"){var e=!Buffer.from;if(!e)try{Buffer.from("foo","utf8")}catch{e=!0}return e?function(t,n){return n?new Buffer(t,n):new Buffer(t)}:Buffer.from.bind(Buffer)}return function(){}}();function St(e){if(Z){if(Buffer.alloc)return Buffer.alloc(e);var t=new Buffer(e);return t.fill(0),t}return typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}function At(e){return Z?Buffer.allocUnsafe?Buffer.allocUnsafe(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}var he=function(t){return Z?Qe(t,"binary"):t.split("").map(function(n){return n.charCodeAt(0)&255})},me=/\u0000/g,Oe=/[\u0001-\u0006]/g,Ve=function(e){for(var t=[],n=0;n<e[0].length;++n)t.push.apply(t,e[0][n]);return t},en=Ve,De=function(e,t,n){for(var h=[],a=t;a<n;a+=2)h.push(String.fromCharCode(Bt(e,a)));return h.join("").replace(me,"")},tn=De,Re=function(e,t,n){for(var h=[],a=t;a<t+n;++a)h.push(("0"+e[a].toString(16)).slice(-2));return h.join("")},rn=Re,kt=function(e){if(Array.isArray(e[0]))return[].concat.apply([],e);var t=0,n=0;for(n=0;n<e.length;++n)t+=e[n].length;var h=new Uint8Array(t);for(n=0,t=0;n<e.length;t+=e[n].length,++n)h.set(e[n],t);return h},ce=kt;Z&&(De=function(e,t,n){return Buffer.isBuffer(e)?e.toString("utf16le",t,n).replace(me,""):tn(e,t,n)},Re=function(e,t,n){return Buffer.isBuffer(e)?e.toString("hex",t,t+n):rn(e,t,n)},Ve=function(e){return e[0].length>0&&Buffer.isBuffer(e[0][0])?Buffer.concat(e[0]):en(e)},he=function(e){return Qe(e,"binary")},ce=function(e){return Buffer.isBuffer(e[0])?Buffer.concat(e):kt(e)});var nn=function(e,t){return e[t]},Bt=function(e,t){return e[t+1]*256+e[t]},sn=function(e,t){var n=e[t+1]*256+e[t];return n<32768?n:(65535-n+1)*-1},Ct=function(e,t){return e[t+3]*(1<<24)+(e[t+2]<<16)+(e[t+1]<<8)+e[t]},le=function(e,t){return(e[t+3]<<24)+(e[t+2]<<16)+(e[t+1]<<8)+e[t]};function Pt(e,t){var n,h,a=0;switch(e){case 1:n=nn(this,this.l);break;case 2:n=(t!=="i"?Bt:sn)(this,this.l);break;case 4:n=le(this,this.l);break;case 16:a=2,h=Re(this,this.l,e)}return this.l+=e,a===0?n:h}var an=function(e,t,n){e[n]=t&255,e[n+1]=t>>>8&255,e[n+2]=t>>>16&255,e[n+3]=t>>>24&255},fn=function(e,t,n){e[n]=t&255,e[n+1]=t>>8&255,e[n+2]=t>>16&255,e[n+3]=t>>24&255};function on(e,t,n){var h=0,a=0;switch(n){case"hex":for(;a<e;++a)this[this.l++]=parseInt(t.slice(2*a,2*a+2),16)||0;return this;case"utf16le":var c=this.l+e;for(a=0;a<Math.min(t.length,e);++a){var w=t.charCodeAt(a);this[this.l++]=w&255,this[this.l++]=w>>8}for(;this.l<c;)this[this.l++]=0;return this}switch(e){case 1:h=1,this[this.l]=t&255;break;case 2:h=2,this[this.l]=t&255,t>>>=8,this[this.l+1]=t&255;break;case 4:h=4,an(this,t,this.l);break;case-4:h=4,fn(this,t,this.l);break}return this.l+=h,this}function Ot(e,t){var n=Re(this,this.l,e.length>>1);if(n!==e)throw new Error(t+"Expected "+e+" saw "+n);this.l+=e.length>>1}function ne(e,t){e.l=t,e.read_shift=Pt,e.chk=Ot,e.write_shift=on}function Q(e){var t=St(e);return ne(t,0),t}var Tt=function(){var e={};e.version="1.2.1";function t(){for(var A=0,K=new Array(256),T=0;T!=256;++T)A=T,A=A&1?-306674912^A>>>1:A>>>1,A=A&1?-306674912^A>>>1:A>>>1,A=A&1?-306674912^A>>>1:A>>>1,A=A&1?-306674912^A>>>1:A>>>1,A=A&1?-306674912^A>>>1:A>>>1,A=A&1?-306674912^A>>>1:A>>>1,A=A&1?-306674912^A>>>1:A>>>1,A=A&1?-306674912^A>>>1:A>>>1,K[T]=A;return typeof Int32Array<"u"?new Int32Array(K):K}var n=t();function h(A){var K=0,T=0,B=0,O=typeof Int32Array<"u"?new Int32Array(4096):new Array(4096);for(B=0;B!=256;++B)O[B]=A[B];for(B=0;B!=256;++B)for(T=A[B],K=256+B;K<4096;K+=256)T=O[K]=T>>>8^A[T&255];var U=[];for(B=1;B!=16;++B)U[B-1]=typeof Int32Array<"u"?O.subarray(B*256,B*256+256):O.slice(B*256,B*256+256);return U}var a=h(n),c=a[0],w=a[1],v=a[2],l=a[3],y=a[4],N=a[5],k=a[6],R=a[7],L=a[8],P=a[9],z=a[10],j=a[11],pe=a[12],ge=a[13],be=a[14];function Ne(A,K){for(var T=K^-1,B=0,O=A.length;B<O;)T=T>>>8^n[(T^A.charCodeAt(B++))&255];return~T}function $e(A,K){for(var T=K^-1,B=A.length-15,O=0;O<B;)T=be[A[O++]^T&255]^ge[A[O++]^T>>8&255]^pe[A[O++]^T>>16&255]^j[A[O++]^T>>>24]^z[A[O++]]^P[A[O++]]^L[A[O++]]^R[A[O++]]^k[A[O++]]^N[A[O++]]^y[A[O++]]^l[A[O++]]^v[A[O++]]^w[A[O++]]^c[A[O++]]^n[A[O++]];for(B+=15;O<B;)T=T>>>8^n[(T^A[O++])&255];return~T}function ze(A,K){for(var T=K^-1,B=0,O=A.length,U=0,b=0;B<O;)U=A.charCodeAt(B++),U<128?T=T>>>8^n[(T^U)&255]:U<2048?(T=T>>>8^n[(T^(192|U>>6&31))&255],T=T>>>8^n[(T^(128|U&63))&255]):U>=55296&&U<57344?(U=(U&1023)+64,b=A.charCodeAt(B++)&1023,T=T>>>8^n[(T^(240|U>>8&7))&255],T=T>>>8^n[(T^(128|U>>2&63))&255],T=T>>>8^n[(T^(128|b>>6&15|(U&3)<<4))&255],T=T>>>8^n[(T^(128|b&63))&255]):(T=T>>>8^n[(T^(224|U>>12&15))&255],T=T>>>8^n[(T^(128|U>>6&63))&255],T=T>>>8^n[(T^(128|U&63))&255]);return~T}return e.table=n,e.bstr=Ne,e.buf=$e,e.str=ze,e}(),de=function(){var t={};t.version="1.2.2";function n(r,f){for(var i=r.split("/"),s=f.split("/"),o=0,u=0,x=Math.min(i.length,s.length);o<x;++o){if(u=i[o].length-s[o].length)return u;if(i[o]!=s[o])return i[o]<s[o]?-1:1}return i.length-s.length}function h(r){if(r.charAt(r.length-1)=="/")return r.slice(0,-1).indexOf("/")===-1?r:h(r.slice(0,-1));var f=r.lastIndexOf("/");return f===-1?r:r.slice(0,f+1)}function a(r){if(r.charAt(r.length-1)=="/")return a(r.slice(0,-1));var f=r.lastIndexOf("/");return f===-1?r:r.slice(f+1)}function c(r,f){typeof f=="string"&&(f=new Date(f));var i=f.getHours();i=i<<6|f.getMinutes(),i=i<<5|f.getSeconds()>>>1,r.write_shift(2,i);var s=f.getFullYear()-1980;s=s<<4|f.getMonth()+1,s=s<<5|f.getDate(),r.write_shift(2,s)}function w(r){var f=r.read_shift(2)&65535,i=r.read_shift(2)&65535,s=new Date,o=i&31;i>>>=5;var u=i&15;i>>>=4,s.setMilliseconds(0),s.setFullYear(i+1980),s.setMonth(u-1),s.setDate(o);var x=f&31;f>>>=5;var _=f&63;return f>>>=6,s.setHours(f),s.setMinutes(_),s.setSeconds(x<<1),s}function v(r){ne(r,0);for(var f={},i=0;r.l<=r.length-4;){var s=r.read_shift(2),o=r.read_shift(2),u=r.l+o,x={};switch(s){case 21589:i=r.read_shift(1),i&1&&(x.mtime=r.read_shift(4)),o>5&&(i&2&&(x.atime=r.read_shift(4)),i&4&&(x.ctime=r.read_shift(4))),x.mtime&&(x.mt=new Date(x.mtime*1e3));break}r.l=u,f[s]=x}return f}var l;function y(){return l||(l=require("fs"))}function N(r,f){if(r[0]==80&&r[1]==75)return Et(r,f);if((r[0]|32)==109&&(r[1]|32)==105)return $r(r,f);if(r.length<512)throw new Error("CFB file size "+r.length+" < 512");var i=3,s=512,o=0,u=0,x=0,_=0,d=0,p=[],g=r.slice(0,512);ne(g,0);var E=k(g);switch(i=E[0],i){case 3:s=512;break;case 4:s=4096;break;case 0:if(E[1]==0)return Et(r,f);default:throw new Error("Major Version: Expected 3 or 4 saw "+i)}s!==512&&(g=r.slice(0,s),ne(g,28));var m=r.slice(0,s);R(g,i);var C=g.read_shift(4,"i");if(i===3&&C!==0)throw new Error("# Directory Sectors: Expected 0 saw "+C);g.l+=4,x=g.read_shift(4,"i"),g.l+=4,g.chk("00100000","Mini Stream Cutoff Size: "),_=g.read_shift(4,"i"),o=g.read_shift(4,"i"),d=g.read_shift(4,"i"),u=g.read_shift(4,"i");for(var F=-1,I=0;I<109&&(F=g.read_shift(4,"i"),!(F<0));++I)p[I]=F;var S=L(r,s);j(d,u,S,s,p);var V=ge(S,x,p,s);V[x].name="!Directory",o>0&&_!==b&&(V[_].name="!MiniFAT"),V[p[0]].name="!FAT",V.fat_addrs=p,V.ssz=s;var $={},H=[],Y=[],ye=[];be(x,V,S,H,o,$,Y,_),P(Y,ye,H),H.shift();var Ee={FileIndex:Y,FullPaths:ye};return f&&f.raw&&(Ee.raw={header:m,sectors:S}),Ee}function k(r){if(r[r.l]==80&&r[r.l+1]==75)return[0,0];r.chk(ut,"Header Signature: "),r.l+=16;var f=r.read_shift(2,"u");return[r.read_shift(2,"u"),f]}function R(r,f){var i=9;switch(r.l+=2,i=r.read_shift(2)){case 9:if(f!=3)throw new Error("Sector Shift: Expected 9 saw "+i);break;case 12:if(f!=4)throw new Error("Sector Shift: Expected 12 saw "+i);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+i)}r.chk("0600","Mini Sector Shift: "),r.chk("000000000000","Reserved: ")}function L(r,f){for(var i=Math.ceil(r.length/f)-1,s=[],o=1;o<i;++o)s[o-1]=r.slice(o*f,(o+1)*f);return s[i-1]=r.slice(i*f),s}function P(r,f,i){for(var s=0,o=0,u=0,x=0,_=0,d=i.length,p=[],g=[];s<d;++s)p[s]=g[s]=s,f[s]=i[s];for(;_<g.length;++_)s=g[_],o=r[s].L,u=r[s].R,x=r[s].C,p[s]===s&&(o!==-1&&p[o]!==o&&(p[s]=p[o]),u!==-1&&p[u]!==u&&(p[s]=p[u])),x!==-1&&(p[x]=s),o!==-1&&s!=p[s]&&(p[o]=p[s],g.lastIndexOf(o)<_&&g.push(o)),u!==-1&&s!=p[s]&&(p[u]=p[s],g.lastIndexOf(u)<_&&g.push(u));for(s=1;s<d;++s)p[s]===s&&(u!==-1&&p[u]!==u?p[s]=p[u]:o!==-1&&p[o]!==o&&(p[s]=p[o]));for(s=1;s<d;++s)if(r[s].type!==0){if(_=s,_!=p[_])do _=p[_],f[s]=f[_]+"/"+f[s];while(_!==0&&p[_]!==-1&&_!=p[_]);p[s]=-1}for(f[0]+="/",s=1;s<d;++s)r[s].type!==2&&(f[s]+="/")}function z(r,f,i){for(var s=r.start,o=r.size,u=[],x=s;i&&o>0&&x>=0;)u.push(f.slice(x*U,x*U+U)),o-=U,x=le(i,x*4);return u.length===0?Q(0):ce(u).slice(0,r.size)}function j(r,f,i,s,o){var u=b;if(r===b){if(f!==0)throw new Error("DIFAT chain shorter than expected")}else if(r!==-1){var x=i[r],_=(s>>>2)-1;if(!x)return;for(var d=0;d<_&&(u=le(x,d*4))!==b;++d)o.push(u);f>=1&&j(le(x,s-4),f-1,i,s,o)}}function pe(r,f,i,s,o){var u=[],x=[];o||(o=[]);var _=s-1,d=0,p=0;for(d=f;d>=0;){o[d]=!0,u[u.length]=d,x.push(r[d]);var g=i[Math.floor(d*4/s)];if(p=d*4&_,s<4+p)throw new Error("FAT boundary crossed: "+d+" 4 "+s);if(!r[g])break;d=le(r[g],p)}return{nodes:u,data:Ve([x])}}function ge(r,f,i,s){var o=r.length,u=[],x=[],_=[],d=[],p=s-1,g=0,E=0,m=0,C=0;for(g=0;g<o;++g)if(_=[],m=g+f,m>=o&&(m-=o),!x[m]){d=[];var F=[];for(E=m;E>=0;){F[E]=!0,x[E]=!0,_[_.length]=E,d.push(r[E]);var I=i[Math.floor(E*4/s)];if(C=E*4&p,s<4+C)throw new Error("FAT boundary crossed: "+E+" 4 "+s);if(!r[I]||(E=le(r[I],C),F[E]))break}u[m]={nodes:_,data:Ve([d])}}return u}function be(r,f,i,s,o,u,x,_){for(var d=0,p=s.length?2:0,g=f[r].data,E=0,m=0,C;E<g.length;E+=128){var F=g.slice(E,E+128);ne(F,64),m=F.read_shift(2),C=De(F,0,m-p),s.push(C);var I={name:C,type:F.read_shift(1),color:F.read_shift(1),L:F.read_shift(4,"i"),R:F.read_shift(4,"i"),C:F.read_shift(4,"i"),clsid:F.read_shift(16),state:F.read_shift(4,"i"),start:0,size:0},S=F.read_shift(2)+F.read_shift(2)+F.read_shift(2)+F.read_shift(2);S!==0&&(I.ct=Ne(F,F.l-8));var V=F.read_shift(2)+F.read_shift(2)+F.read_shift(2)+F.read_shift(2);V!==0&&(I.mt=Ne(F,F.l-8)),I.start=F.read_shift(4,"i"),I.size=F.read_shift(4,"i"),I.size<0&&I.start<0&&(I.size=I.type=0,I.start=b,I.name=""),I.type===5?(d=I.start,o>0&&d!==b&&(f[d].name="!StreamData")):I.size>=4096?(I.storage="fat",f[I.start]===void 0&&(f[I.start]=pe(i,I.start,f.fat_addrs,f.ssz)),f[I.start].name=I.name,I.content=f[I.start].data.slice(0,I.size)):(I.storage="minifat",I.size<0?I.size=0:d!==b&&I.start!==b&&f[d]&&(I.content=z(I,f[d].data,(f[_]||{}).data))),I.content&&ne(I.content,0),u[C]=I,x.push(I)}}function Ne(r,f){return new Date((Ct(r,f+4)/1e7*Math.pow(2,32)+Ct(r,f)/1e7-11644473600)*1e3)}function $e(r,f){return y(),N(l.readFileSync(r),f)}function ze(r,f){var i=f&&f.type;switch(i||Z&&Buffer.isBuffer(r)&&(i="buffer"),i||"base64"){case"file":return $e(r,f);case"base64":return N(he(Nt(r)),f);case"binary":return N(he(r),f)}return N(r,f)}function A(r,f){var i=f||{},s=i.root||"Root Entry";if(r.FullPaths||(r.FullPaths=[]),r.FileIndex||(r.FileIndex=[]),r.FullPaths.length!==r.FileIndex.length)throw new Error("inconsistent CFB structure");r.FullPaths.length===0&&(r.FullPaths[0]=s+"/",r.FileIndex[0]={name:s,type:5}),i.CLSID&&(r.FileIndex[0].clsid=i.CLSID),K(r)}function K(r){var f="Sh33tJ5";if(!de.find(r,"/"+f)){var i=Q(4);i[0]=55,i[1]=i[3]=50,i[2]=54,r.FileIndex.push({name:f,type:2,content:i,size:4,L:69,R:69,C:69}),r.FullPaths.push(r.FullPaths[0]+f),T(r)}}function T(r,f){A(r);for(var i=!1,s=!1,o=r.FullPaths.length-1;o>=0;--o){var u=r.FileIndex[o];switch(u.type){case 0:s?i=!0:(r.FileIndex.pop(),r.FullPaths.pop());break;case 1:case 2:case 5:s=!0,isNaN(u.R*u.L*u.C)&&(i=!0),u.R>-1&&u.L>-1&&u.R==u.L&&(i=!0);break;default:i=!0;break}}if(!(!i&&!f)){var x=new Date(1987,1,19),_=0,d=Object.create?Object.create(null):{},p=[];for(o=0;o<r.FullPaths.length;++o)d[r.FullPaths[o]]=!0,r.FileIndex[o].type!==0&&p.push([r.FullPaths[o],r.FileIndex[o]]);for(o=0;o<p.length;++o){var g=h(p[o][0]);for(s=d[g];!s;){for(;h(g)&&!d[h(g)];)g=h(g);p.push([g,{name:a(g).replace("/",""),type:1,clsid:je,ct:x,mt:x,content:null}]),d[g]=!0,g=h(p[o][0]),s=d[g]}}for(p.sort(function(C,F){return n(C[0],F[0])}),r.FullPaths=[],r.FileIndex=[],o=0;o<p.length;++o)r.FullPaths[o]=p[o][0],r.FileIndex[o]=p[o][1];for(o=0;o<p.length;++o){var E=r.FileIndex[o],m=r.FullPaths[o];if(E.name=a(m).replace("/",""),E.L=E.R=E.C=-(E.color=1),E.size=E.content?E.content.length:0,E.start=0,E.clsid=E.clsid||je,o===0)E.C=p.length>1?1:-1,E.size=0,E.type=5;else if(m.slice(-1)=="/"){for(_=o+1;_<p.length&&h(r.FullPaths[_])!=m;++_);for(E.C=_>=p.length?-1:_,_=o+1;_<p.length&&h(r.FullPaths[_])!=h(m);++_);E.R=_>=p.length?-1:_,E.type=1}else h(r.FullPaths[o+1]||"")==h(m)&&(E.R=o+1),E.type=2}}}function B(r,f){var i=f||{};if(i.fileType=="mad")return zr(r,i);switch(T(r),i.fileType){case"zip":return Rr(r,i)}var s=function(C){for(var F=0,I=0,S=0;S<C.FileIndex.length;++S){var V=C.FileIndex[S];if(V.content){var $=V.content.length;$>0&&($<4096?F+=$+63>>6:I+=$+511>>9)}}for(var H=C.FullPaths.length+3>>2,Y=F+7>>3,ye=F+127>>7,Ee=Y+I+H+ye,fe=Ee+127>>7,Je=fe<=109?0:Math.ceil((fe-109)/127);Ee+fe+Je+127>>7>fe;)Je=++fe<=109?0:Math.ceil((fe-109)/127);var te=[1,Je,fe,ye,H,I,F,0];return C.FileIndex[0].size=F<<6,te[7]=(C.FileIndex[0].start=te[0]+te[1]+te[2]+te[3]+te[4]+te[5])+(te[6]+7>>3),te}(r),o=Q(s[7]<<9),u=0,x=0;{for(u=0;u<8;++u)o.write_shift(1,wr[u]);for(u=0;u<8;++u)o.write_shift(2,0);for(o.write_shift(2,62),o.write_shift(2,3),o.write_shift(2,65534),o.write_shift(2,9),o.write_shift(2,6),u=0;u<3;++u)o.write_shift(2,0);for(o.write_shift(4,0),o.write_shift(4,s[2]),o.write_shift(4,s[0]+s[1]+s[2]+s[3]-1),o.write_shift(4,0),o.write_shift(4,4096),o.write_shift(4,s[3]?s[0]+s[1]+s[2]-1:b),o.write_shift(4,s[3]),o.write_shift(-4,s[1]?s[0]-1:b),o.write_shift(4,s[1]),u=0;u<109;++u)o.write_shift(-4,u<s[2]?s[1]+u:-1)}if(s[1])for(x=0;x<s[1];++x){for(;u<236+x*127;++u)o.write_shift(-4,u<s[2]?s[1]+u:-1);o.write_shift(-4,x===s[1]-1?b:x+1)}var _=function(C){for(x+=C;u<x-1;++u)o.write_shift(-4,u+1);C&&(++u,o.write_shift(-4,b))};for(x=u=0,x+=s[1];u<x;++u)o.write_shift(-4,_e.DIFSECT);for(x+=s[2];u<x;++u)o.write_shift(-4,_e.FATSECT);_(s[3]),_(s[4]);for(var d=0,p=0,g=r.FileIndex[0];d<r.FileIndex.length;++d)g=r.FileIndex[d],g.content&&(p=g.content.length,!(p<4096)&&(g.start=x,_(p+511>>9)));for(_(s[6]+7>>3);o.l&511;)o.write_shift(-4,_e.ENDOFCHAIN);for(x=u=0,d=0;d<r.FileIndex.length;++d)g=r.FileIndex[d],g.content&&(p=g.content.length,!(!p||p>=4096)&&(g.start=x,_(p+63>>6)));for(;o.l&511;)o.write_shift(-4,_e.ENDOFCHAIN);for(u=0;u<s[4]<<2;++u){var E=r.FullPaths[u];if(!E||E.length===0){for(d=0;d<17;++d)o.write_shift(4,0);for(d=0;d<3;++d)o.write_shift(4,-1);for(d=0;d<12;++d)o.write_shift(4,0);continue}g=r.FileIndex[u],u===0&&(g.start=g.size?g.start-1:b);var m=u===0&&i.root||g.name;if(m.length>32&&(console.error("Name "+m+" will be truncated to "+m.slice(0,32)),m=m.slice(0,32)),p=2*(m.length+1),o.write_shift(64,m,"utf16le"),o.write_shift(2,p),o.write_shift(1,g.type),o.write_shift(1,g.color),o.write_shift(-4,g.L),o.write_shift(-4,g.R),o.write_shift(-4,g.C),g.clsid)o.write_shift(16,g.clsid,"hex");else for(d=0;d<4;++d)o.write_shift(4,0);o.write_shift(4,g.state||0),o.write_shift(4,0),o.write_shift(4,0),o.write_shift(4,0),o.write_shift(4,0),o.write_shift(4,g.start),o.write_shift(4,g.size),o.write_shift(4,0)}for(u=1;u<r.FileIndex.length;++u)if(g=r.FileIndex[u],g.size>=4096)if(o.l=g.start+1<<9,Z&&Buffer.isBuffer(g.content))g.content.copy(o,o.l,0,g.size),o.l+=g.size+511&-512;else{for(d=0;d<g.size;++d)o.write_shift(1,g.content[d]);for(;d&511;++d)o.write_shift(1,0)}for(u=1;u<r.FileIndex.length;++u)if(g=r.FileIndex[u],g.size>0&&g.size<4096)if(Z&&Buffer.isBuffer(g.content))g.content.copy(o,o.l,0,g.size),o.l+=g.size+63&-64;else{for(d=0;d<g.size;++d)o.write_shift(1,g.content[d]);for(;d&63;++d)o.write_shift(1,0)}if(Z)o.l=o.length;else for(;o.l<o.length;)o.write_shift(1,0);return o}function O(r,f){var i=r.FullPaths.map(function(d){return d.toUpperCase()}),s=i.map(function(d){var p=d.split("/");return p[p.length-(d.slice(-1)=="/"?2:1)]}),o=!1;f.charCodeAt(0)===47?(o=!0,f=i[0].slice(0,-1)+f):o=f.indexOf("/")!==-1;var u=f.toUpperCase(),x=o===!0?i.indexOf(u):s.indexOf(u);if(x!==-1)return r.FileIndex[x];var _=!u.match(Oe);for(u=u.replace(me,""),_&&(u=u.replace(Oe,"!")),x=0;x<i.length;++x)if((_?i[x].replace(Oe,"!"):i[x]).replace(me,"")==u||(_?s[x].replace(Oe,"!"):s[x]).replace(me,"")==u)return r.FileIndex[x];return null}var U=64,b=-2,ut="d0cf11e0a1b11ae1",wr=[208,207,17,224,161,177,26,225],je="00000000000000000000000000000000",_e={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:b,FREESECT:-1,HEADER_SIGNATURE:ut,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:je,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function yr(r,f,i){y();var s=B(r,i);l.writeFileSync(f,s)}function ve(r){for(var f=new Array(r.length),i=0;i<r.length;++i)f[i]=String.fromCharCode(r[i]);return f.join("")}function Er(r,f){var i=B(r,f);switch(f&&f.type||"buffer"){case"file":return y(),l.writeFileSync(f.filename,i),i;case"binary":return typeof i=="string"?i:ve(i);case"base64":return It(typeof i=="string"?i:ve(i));case"buffer":if(Z)return Buffer.isBuffer(i)?i:Qe(i);case"array":return typeof i=="string"?he(i):i}return i}var we;function mr(r){try{var f=r.InflateRaw,i=new f;if(i._processChunk(new Uint8Array([3,0]),i._finishFlushFlag),i.bytesRead)we=r;else throw new Error("zlib does not expose bytesRead")}catch(s){console.error("cannot use native zlib: "+(s.message||s))}}function Fr(r,f){if(!we)return yt(r,f);var i=we.InflateRaw,s=new i,o=s._processChunk(r.slice(r.l),s._finishFlushFlag);return r.l+=s.bytesRead,o}function Ir(r){return we?we.deflateRawSync(r):xt(r)}var Nr=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],Ae=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],Ce=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];function Ar(r){var f=(r<<1|r<<11)&139536|(r<<5|r<<15)&558144;return(f>>16|f>>8|f)&255}for(var X=typeof Uint8Array<"u",ee=X?new Uint8Array(256):[],Te=0;Te<256;++Te)ee[Te]=Ar(Te);function Cr(r,f){var i=ee[r&255];return f<=8?i>>>8-f:(i=i<<8|ee[r>>8&255],f<=16?i>>>16-f:(i=i<<8|ee[r>>16&255],i>>>24-f))}function Tr(r,f){var i=f&7,s=f>>>3;return(r[s]|(i<=6?0:r[s+1]<<8))>>>i&3}function Ke(r,f){var i=f&7,s=f>>>3;return(r[s]|(i<=5?0:r[s+1]<<8))>>>i&7}function Sr(r,f){var i=f&7,s=f>>>3;return(r[s]|(i<=4?0:r[s+1]<<8))>>>i&15}function ht(r,f){var i=f&7,s=f>>>3;return(r[s]|(i<=3?0:r[s+1]<<8))>>>i&31}function ct(r,f){var i=f&7,s=f>>>3;return(r[s]|(i<=1?0:r[s+1]<<8))>>>i&127}function Se(r,f,i){var s=f&7,o=f>>>3,u=(1<<i)-1,x=r[o]>>>s;return i<8-s||(x|=r[o+1]<<8-s,i<16-s)||(x|=r[o+2]<<16-s,i<24-s)||(x|=r[o+3]<<24-s),x&u}function lt(r,f,i){var s=f&7,o=f>>>3;return s<=5?r[o]|=(i&7)<<s:(r[o]|=i<<s&255,r[o+1]=(i&7)>>8-s),f+3}function kr(r,f,i){var s=f&7,o=f>>>3;return i=(i&1)<<s,r[o]|=i,f+1}function ue(r,f,i){var s=f&7,o=f>>>3;return i<<=s,r[o]|=i&255,i>>>=8,r[o+1]=i,f+8}function dt(r,f,i){var s=f&7,o=f>>>3;return i<<=s,r[o]|=i&255,i>>>=8,r[o+1]=i&255,r[o+2]=i>>>8,f+16}function Xe(r,f){var i=r.length,s=2*i>f?2*i:f+5,o=0;if(i>=f)return r;if(Z){var u=At(s);if(r.copy)r.copy(u);else for(;o<r.length;++o)u[o]=r[o];return u}else if(X){var x=new Uint8Array(s);if(x.set)x.set(r);else for(;o<i;++o)x[o]=r[o];return x}return r.length=s,r}function W(r){for(var f=new Array(r),i=0;i<r;++i)f[i]=0;return f}function ke(r,f,i){var s=1,o=0,u=0,x=0,_=0,d=r.length,p=X?new Uint16Array(32):W(32);for(u=0;u<32;++u)p[u]=0;for(u=d;u<i;++u)r[u]=0;d=r.length;var g=X?new Uint16Array(d):W(d);for(u=0;u<d;++u)p[o=r[u]]++,s<o&&(s=o),g[u]=0;for(p[0]=0,u=1;u<=s;++u)p[u+16]=_=_+p[u-1]<<1;for(u=0;u<d;++u)_=r[u],_!=0&&(g[u]=p[_+16]++);var E=0;for(u=0;u<d;++u)if(E=r[u],E!=0)for(_=Cr(g[u],s)>>s-E,x=(1<<s+4-E)-1;x>=0;--x)f[_|x<<E]=E&15|u<<4;return s}var Ge=X?new Uint16Array(512):W(512),Ye=X?new Uint16Array(32):W(32);if(!X){for(var ae=0;ae<512;++ae)Ge[ae]=0;for(ae=0;ae<32;++ae)Ye[ae]=0}(function(){for(var r=[],f=0;f<32;f++)r.push(5);ke(r,Ye,32);var i=[];for(f=0;f<=143;f++)i.push(8);for(;f<=255;f++)i.push(9);for(;f<=279;f++)i.push(7);for(;f<=287;f++)i.push(8);ke(i,Ge,288)})();var Br=function(){for(var f=X?new Uint8Array(32768):[],i=0,s=0;i<Ce.length-1;++i)for(;s<Ce[i+1];++s)f[s]=i;for(;s<32768;++s)f[s]=29;var o=X?new Uint8Array(259):[];for(i=0,s=0;i<Ae.length-1;++i)for(;s<Ae[i+1];++s)o[s]=i;function u(_,d){for(var p=0;p<_.length;){var g=Math.min(65535,_.length-p),E=p+g==_.length;for(d.write_shift(1,+E),d.write_shift(2,g),d.write_shift(2,~g&65535);g-- >0;)d[d.l++]=_[p++]}return d.l}function x(_,d){for(var p=0,g=0,E=X?new Uint16Array(32768):[];g<_.length;){var m=Math.min(65535,_.length-g);if(m<10){for(p=lt(d,p,+(g+m==_.length)),p&7&&(p+=8-(p&7)),d.l=p/8|0,d.write_shift(2,m),d.write_shift(2,~m&65535);m-- >0;)d[d.l++]=_[g++];p=d.l*8;continue}p=lt(d,p,+(g+m==_.length)+2);for(var C=0;m-- >0;){var F=_[g];C=(C<<5^F)&32767;var I=-1,S=0;if((I=E[C])&&(I|=g&-32768,I>g&&(I-=32768),I<g))for(;_[I+S]==_[g+S]&&S<250;)++S;if(S>2){F=o[S],F<=22?p=ue(d,p,ee[F+1]>>1)-1:(ue(d,p,3),p+=5,ue(d,p,ee[F-23]>>5),p+=3);var V=F<8?0:F-4>>2;V>0&&(dt(d,p,S-Ae[F]),p+=V),F=f[g-I],p=ue(d,p,ee[F]>>3),p-=3;var $=F<4?0:F-2>>1;$>0&&(dt(d,p,g-I-Ce[F]),p+=$);for(var H=0;H<S;++H)E[C]=g&32767,C=(C<<5^_[g])&32767,++g;m-=S-1}else F<=143?F=F+48:p=kr(d,p,1),p=ue(d,p,ee[F]),E[C]=g&32767,++g}p=ue(d,p,0)-1}return d.l=(p+7)/8|0,d.l}return function(d,p){return d.length<8?u(d,p):x(d,p)}}();function xt(r){var f=Q(50+Math.floor(r.length*1.1)),i=Br(r,f);return f.slice(0,i)}var pt=X?new Uint16Array(32768):W(32768),gt=X?new Uint16Array(32768):W(32768),_t=X?new Uint16Array(128):W(128),vt=1,wt=1;function Pr(r,f){var i=ht(r,f)+257;f+=5;var s=ht(r,f)+1;f+=5;var o=Sr(r,f)+4;f+=4;for(var u=0,x=X?new Uint8Array(19):W(19),_=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],d=1,p=X?new Uint8Array(8):W(8),g=X?new Uint8Array(8):W(8),E=x.length,m=0;m<o;++m)x[Nr[m]]=u=Ke(r,f),d<u&&(d=u),p[u]++,f+=3;var C=0;for(p[0]=0,m=1;m<=d;++m)g[m]=C=C+p[m-1]<<1;for(m=0;m<E;++m)(C=x[m])!=0&&(_[m]=g[C]++);var F=0;for(m=0;m<E;++m)if(F=x[m],F!=0){C=ee[_[m]]>>8-F;for(var I=(1<<7-F)-1;I>=0;--I)_t[C|I<<F]=F&7|m<<3}var S=[];for(d=1;S.length<i+s;)switch(C=_t[ct(r,f)],f+=C&7,C>>>=3){case 16:for(u=3+Tr(r,f),f+=2,C=S[S.length-1];u-- >0;)S.push(C);break;case 17:for(u=3+Ke(r,f),f+=3;u-- >0;)S.push(0);break;case 18:for(u=11+ct(r,f),f+=7;u-- >0;)S.push(0);break;default:S.push(C),d<C&&(d=C);break}var V=S.slice(0,i),$=S.slice(i);for(m=i;m<286;++m)V[m]=0;for(m=s;m<30;++m)$[m]=0;return vt=ke(V,pt,286),wt=ke($,gt,30),f}function Or(r,f){if(r[0]==3&&!(r[1]&3))return[St(f),2];for(var i=0,s=0,o=At(f||1<<18),u=0,x=o.length>>>0,_=0,d=0;!(s&1);){if(s=Ke(r,i),i+=3,s>>>1)s>>1==1?(_=9,d=5):(i=Pr(r,i),_=vt,d=wt);else{i&7&&(i+=8-(i&7));var p=r[i>>>3]|r[(i>>>3)+1]<<8;if(i+=32,p>0)for(!f&&x<u+p&&(o=Xe(o,u+p),x=o.length);p-- >0;)o[u++]=r[i>>>3],i+=8;continue}for(;;){!f&&x<u+32767&&(o=Xe(o,u+32767),x=o.length);var g=Se(r,i,_),E=s>>>1==1?Ge[g]:pt[g];if(i+=E&15,E>>>=4,!(E>>>8&255))o[u++]=E;else{if(E==256)break;E-=257;var m=E<8?0:E-4>>2;m>5&&(m=0);var C=u+Ae[E];m>0&&(C+=Se(r,i,m),i+=m),g=Se(r,i,d),E=s>>>1==1?Ye[g]:gt[g],i+=E&15,E>>>=4;var F=E<4?0:E-2>>1,I=Ce[E];for(F>0&&(I+=Se(r,i,F),i+=F),!f&&x<C&&(o=Xe(o,C+100),x=o.length);u<C;)o[u]=o[u-I],++u}}}return f?[o,i+7>>>3]:[o.slice(0,u),i+7>>>3]}function yt(r,f){var i=r.slice(r.l||0),s=Or(i,f);return r.l+=s[1],s[0]}function qe(r,f){if(r)typeof console<"u"&&console.error(f);else throw new Error(f)}function Et(r,f){var i=r;ne(i,0);var s=[],o=[],u={FileIndex:s,FullPaths:o};A(u,{root:f.root});for(var x=i.length-4;(i[x]!=80||i[x+1]!=75||i[x+2]!=5||i[x+3]!=6)&&x>=0;)--x;i.l=x+4,i.l+=4;var _=i.read_shift(2);i.l+=6;var d=i.read_shift(4);for(i.l=d,x=0;x<_;++x){i.l+=20;var p=i.read_shift(4),g=i.read_shift(4),E=i.read_shift(2),m=i.read_shift(2),C=i.read_shift(2);i.l+=8;var F=i.read_shift(4),I=v(i.slice(i.l+E,i.l+E+m));i.l+=E+m+C;var S=i.l;i.l=F+4,Vr(i,p,g,u,I),i.l=S}return u}function Vr(r,f,i,s,o){r.l+=2;var u=r.read_shift(2),x=r.read_shift(2),_=w(r);if(u&8257)throw new Error("Unsupported ZIP encryption");for(var d=r.read_shift(4),p=r.read_shift(4),g=r.read_shift(4),E=r.read_shift(2),m=r.read_shift(2),C="",F=0;F<E;++F)C+=String.fromCharCode(r[r.l++]);if(m){var I=v(r.slice(r.l,r.l+m));(I[21589]||{}).mt&&(_=I[21589].mt),((o||{})[21589]||{}).mt&&(_=o[21589].mt)}r.l+=m;var S=r.slice(r.l,r.l+p);switch(x){case 8:S=Fr(r,g);break;case 0:break;default:throw new Error("Unsupported ZIP Compression method "+x)}var V=!1;u&8&&(d=r.read_shift(4),d==134695760&&(d=r.read_shift(4),V=!0),p=r.read_shift(4),g=r.read_shift(4)),p!=f&&qe(V,"Bad compressed size: "+f+" != "+p),g!=i&&qe(V,"Bad uncompressed size: "+i+" != "+g);var $=Tt.buf(S,0);d>>0!=$>>0&&qe(V,"Bad CRC32 checksum: "+d+" != "+$),Ze(s,C,S,{unsafe:!0,mt:_})}function Rr(r,f){var i=f||{},s=[],o=[],u=Q(1),x=i.compression?8:0,_=0,d=!1;d&&(_|=8);var p=0,g=0,E=0,m=0,C=r.FullPaths[0],F=C,I=r.FileIndex[0],S=[],V=0;for(p=1;p<r.FullPaths.length;++p)if(F=r.FullPaths[p].slice(C.length),I=r.FileIndex[p],!(!I.size||!I.content||F=="Sh33tJ5")){var $=E,H=Q(F.length);for(g=0;g<F.length;++g)H.write_shift(1,F.charCodeAt(g)&127);H=H.slice(0,H.l),S[m]=Tt.buf(I.content,0);var Y=I.content;x==8&&(Y=Ir(Y)),u=Q(30),u.write_shift(4,67324752),u.write_shift(2,20),u.write_shift(2,_),u.write_shift(2,x),I.mt?c(u,I.mt):u.write_shift(4,0),u.write_shift(-4,_&8?0:S[m]),u.write_shift(4,_&8?0:Y.length),u.write_shift(4,_&8?0:I.content.length),u.write_shift(2,H.length),u.write_shift(2,0),E+=u.length,s.push(u),E+=H.length,s.push(H),E+=Y.length,s.push(Y),_&8&&(u=Q(12),u.write_shift(-4,S[m]),u.write_shift(4,Y.length),u.write_shift(4,I.content.length),E+=u.l,s.push(u)),u=Q(46),u.write_shift(4,33639248),u.write_shift(2,0),u.write_shift(2,20),u.write_shift(2,_),u.write_shift(2,x),u.write_shift(4,0),u.write_shift(-4,S[m]),u.write_shift(4,Y.length),u.write_shift(4,I.content.length),u.write_shift(2,H.length),u.write_shift(2,0),u.write_shift(2,0),u.write_shift(2,0),u.write_shift(2,0),u.write_shift(4,0),u.write_shift(4,$),V+=u.l,o.push(u),V+=H.length,o.push(H),++m}return u=Q(22),u.write_shift(4,101010256),u.write_shift(2,0),u.write_shift(2,0),u.write_shift(2,m),u.write_shift(2,m),u.write_shift(4,V),u.write_shift(4,E),u.write_shift(2,0),ce([ce(s),ce(o),u])}var Be={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function Lr(r,f){if(r.ctype)return r.ctype;var i=r.name||"",s=i.match(/\.([^\.]+)$/);return s&&Be[s[1]]||f&&(s=(i=f).match(/[\.\\]([^\.\\])+$/),s&&Be[s[1]])?Be[s[1]]:"application/octet-stream"}function Ur(r){for(var f=It(r),i=[],s=0;s<f.length;s+=76)i.push(f.slice(s,s+76));return i.join(`\r
`)+`\r
`}function Mr(r){var f=r.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,function(p){var g=p.charCodeAt(0).toString(16).toUpperCase();return"="+(g.length==1?"0"+g:g)});f=f.replace(/ $/mg,"=20").replace(/\t$/mg,"=09"),f.charAt(0)==`
`&&(f="=0D"+f.slice(1)),f=f.replace(/\r(?!\n)/mg,"=0D").replace(/\n\n/mg,`
=0A`).replace(/([^\r\n])\n/mg,"$1=0A");for(var i=[],s=f.split(`\r
`),o=0;o<s.length;++o){var u=s[o];if(u.length==0){i.push("");continue}for(var x=0;x<u.length;){var _=76,d=u.slice(x,x+_);d.charAt(_-1)=="="?_--:d.charAt(_-2)=="="?_-=2:d.charAt(_-3)=="="&&(_-=3),d=u.slice(x,x+_),x+=_,x<u.length&&(d+="="),i.push(d)}}return i.join(`\r
`)}function Hr(r){for(var f=[],i=0;i<r.length;++i){for(var s=r[i];i<=r.length&&s.charAt(s.length-1)=="=";)s=s.slice(0,s.length-1)+r[++i];f.push(s)}for(var o=0;o<f.length;++o)f[o]=f[o].replace(/[=][0-9A-Fa-f]{2}/g,function(u){return String.fromCharCode(parseInt(u.slice(1),16))});return he(f.join(`\r
`))}function br(r,f,i){for(var s="",o="",u="",x,_=0;_<10;++_){var d=f[_];if(!d||d.match(/^\s*$/))break;var p=d.match(/^(.*?):\s*([^\s].*)$/);if(p)switch(p[1].toLowerCase()){case"content-location":s=p[2].trim();break;case"content-type":u=p[2].trim();break;case"content-transfer-encoding":o=p[2].trim();break}}switch(++_,o.toLowerCase()){case"base64":x=he(Nt(f.slice(_).join("")));break;case"quoted-printable":x=Hr(f.slice(_));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+o)}var g=Ze(r,s.slice(i.length),x,{unsafe:!0});u&&(g.ctype=u)}function $r(r,f){if(ve(r.slice(0,13)).toLowerCase()!="mime-version:")throw new Error("Unsupported MAD header");var i=f&&f.root||"",s=(Z&&Buffer.isBuffer(r)?r.toString("binary"):ve(r)).split(`\r
`),o=0,u="";for(o=0;o<s.length;++o)if(u=s[o],!!/^Content-Location:/i.test(u)&&(u=u.slice(u.indexOf("file")),i||(i=u.slice(0,u.lastIndexOf("/")+1)),u.slice(0,i.length)!=i))for(;i.length>0&&(i=i.slice(0,i.length-1),i=i.slice(0,i.lastIndexOf("/")+1),u.slice(0,i.length)!=i););var x=(s[1]||"").match(/boundary="(.*?)"/);if(!x)throw new Error("MAD cannot find boundary");var _="--"+(x[1]||""),d=[],p=[],g={FileIndex:d,FullPaths:p};A(g);var E,m=0;for(o=0;o<s.length;++o){var C=s[o];C!==_&&C!==_+"--"||(m++&&br(g,s.slice(E,o),i),E=o)}return g}function zr(r,f){var i=f||{},s=i.boundary||"SheetJS";s="------="+s;for(var o=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+s.slice(2)+'"',"","",""],u=r.FullPaths[0],x=u,_=r.FileIndex[0],d=1;d<r.FullPaths.length;++d)if(x=r.FullPaths[d].slice(u.length),_=r.FileIndex[d],!(!_.size||!_.content||x=="Sh33tJ5")){x=x.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,function(S){return"_x"+S.charCodeAt(0).toString(16)+"_"}).replace(/[\u0080-\uFFFF]/g,function(S){return"_u"+S.charCodeAt(0).toString(16)+"_"});for(var p=_.content,g=Z&&Buffer.isBuffer(p)?p.toString("binary"):ve(p),E=0,m=Math.min(1024,g.length),C=0,F=0;F<=m;++F)(C=g.charCodeAt(F))>=32&&C<128&&++E;var I=E>=m*4/5;o.push(s),o.push("Content-Location: "+(i.root||"file:///C:/SheetJS/")+x),o.push("Content-Transfer-Encoding: "+(I?"quoted-printable":"base64")),o.push("Content-Type: "+Lr(_,x)),o.push(""),o.push(I?Mr(g):Ur(g))}return o.push(s+`--\r
`),o.join(`\r
`)}function jr(r){var f={};return A(f,r),f}function Ze(r,f,i,s){var o=s&&s.unsafe;o||A(r);var u=!o&&de.find(r,f);if(!u){var x=r.FullPaths[0];f.slice(0,x.length)==x?x=f:(x.slice(-1)!="/"&&(x+="/"),x=(x+f).replace("//","/")),u={name:a(f),type:2},r.FileIndex.push(u),r.FullPaths.push(x),o||de.utils.cfb_gc(r)}return u.content=i,u.size=i?i.length:0,s&&(s.CLSID&&(u.clsid=s.CLSID),s.mt&&(u.mt=s.mt),s.ct&&(u.ct=s.ct)),u}function Kr(r,f){A(r);var i=de.find(r,f);if(i){for(var s=0;s<r.FileIndex.length;++s)if(r.FileIndex[s]==i)return r.FileIndex.splice(s,1),r.FullPaths.splice(s,1),!0}return!1}function Xr(r,f,i){A(r);var s=de.find(r,f);if(s){for(var o=0;o<r.FileIndex.length;++o)if(r.FileIndex[o]==s)return r.FileIndex[o].name=a(i),r.FullPaths[o]=i,!0}return!1}function Gr(r){T(r,!0)}return t.find=O,t.read=ze,t.parse=N,t.write=Er,t.writeFile=yr,t.utils={cfb_new:jr,cfb_add:Ze,cfb_del:Kr,cfb_mov:Xr,cfb_gc:Gr,ReadShift:Pt,CheckField:Ot,prep_blob:ne,bconcat:ce,use_zlib:mr,_deflateRaw:xt,_inflateRaw:yt,consts:_e},t}();typeof require<"u"&&typeof We<"u"&&typeof DO_NOT_EXPORT_CFB>"u"&&(We.exports=de)});var Me=q(re=>{"use strict";var Rt=":A-Za-z_\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD",un=Rt+"\\-.\\d\\u00B7\\u0300-\\u036F\\u203F-\\u2040",Lt="["+Rt+"]["+un+"]*",hn=new RegExp("^"+Lt+"$"),cn=function(e,t){let n=[],h=t.exec(e);for(;h;){let a=[];a.startIndex=t.lastIndex-h[0].length;let c=h.length;for(let w=0;w<c;w++)a.push(h[w]);n.push(a),h=t.exec(e)}return n},ln=function(e){let t=hn.exec(e);return!(t===null||typeof t>"u")};re.isExist=function(e){return typeof e<"u"};re.isEmptyObject=function(e){return Object.keys(e).length===0};re.merge=function(e,t,n){if(t){let h=Object.keys(t),a=h.length;for(let c=0;c<a;c++)n==="strict"?e[h[c]]=[t[h[c]]]:e[h[c]]=t[h[c]]}};re.getValue=function(e){return re.isExist(e)?e:""};re.isName=ln;re.getAllMatches=cn;re.nameRegexp=Lt});var tt=q($t=>{"use strict";var et=Me(),dn={allowBooleanAttributes:!1,unpairedTags:[]};$t.validate=function(e,t){t=Object.assign({},dn,t);let n=[],h=!1,a=!1;e[0]==="\uFEFF"&&(e=e.substr(1));for(let c=0;c<e.length;c++)if(e[c]==="<"&&e[c+1]==="?"){if(c+=2,c=Mt(e,c),c.err)return c}else if(e[c]==="<"){let w=c;if(c++,e[c]==="!"){c=Ht(e,c);continue}else{let v=!1;e[c]==="/"&&(v=!0,c++);let l="";for(;c<e.length&&e[c]!==">"&&e[c]!==" "&&e[c]!=="	"&&e[c]!==`
`&&e[c]!=="\r";c++)l+=e[c];if(l=l.trim(),l[l.length-1]==="/"&&(l=l.substring(0,l.length-1),c--),!En(l)){let k;return l.trim().length===0?k="Invalid space after '<'.":k="Tag '"+l+"' is an invalid name.",M("InvalidTag",k,G(e,c))}let y=gn(e,c);if(y===!1)return M("InvalidAttr","Attributes for '"+l+"' have open quote.",G(e,c));let N=y.value;if(c=y.index,N[N.length-1]==="/"){let k=c-N.length;N=N.substring(0,N.length-1);let R=bt(N,t);if(R===!0)h=!0;else return M(R.err.code,R.err.msg,G(e,k+R.err.line))}else if(v)if(y.tagClosed){if(N.trim().length>0)return M("InvalidTag","Closing tag '"+l+"' can't have attributes or invalid starting.",G(e,w));if(n.length===0)return M("InvalidTag","Closing tag '"+l+"' has not been opened.",G(e,w));{let k=n.pop();if(l!==k.tagName){let R=G(e,k.tagStartPos);return M("InvalidTag","Expected closing tag '"+k.tagName+"' (opened in line "+R.line+", col "+R.col+") instead of closing tag '"+l+"'.",G(e,w))}n.length==0&&(a=!0)}}else return M("InvalidTag","Closing tag '"+l+"' doesn't have proper closing.",G(e,c));else{let k=bt(N,t);if(k!==!0)return M(k.err.code,k.err.msg,G(e,c-N.length+k.err.line));if(a===!0)return M("InvalidXml","Multiple possible root nodes found.",G(e,c));t.unpairedTags.indexOf(l)!==-1||n.push({tagName:l,tagStartPos:w}),h=!0}for(c++;c<e.length;c++)if(e[c]==="<")if(e[c+1]==="!"){c++,c=Ht(e,c);continue}else if(e[c+1]==="?"){if(c=Mt(e,++c),c.err)return c}else break;else if(e[c]==="&"){let k=wn(e,c);if(k==-1)return M("InvalidChar","char '&' is not expected.",G(e,c));c=k}else if(a===!0&&!Ut(e[c]))return M("InvalidXml","Extra text at the end",G(e,c));e[c]==="<"&&c--}}else{if(Ut(e[c]))continue;return M("InvalidChar","char '"+e[c]+"' is not expected.",G(e,c))}if(h){if(n.length==1)return M("InvalidTag","Unclosed tag '"+n[0].tagName+"'.",G(e,n[0].tagStartPos));if(n.length>0)return M("InvalidXml","Invalid '"+JSON.stringify(n.map(c=>c.tagName),null,4).replace(/\r?\n/g,"")+"' found.",{line:1,col:1})}else return M("InvalidXml","Start tag expected.",1);return!0};function Ut(e){return e===" "||e==="	"||e===`
`||e==="\r"}function Mt(e,t){let n=t;for(;t<e.length;t++)if(e[t]=="?"||e[t]==" "){let h=e.substr(n,t-n);if(t>5&&h==="xml")return M("InvalidXml","XML declaration allowed only at the start of the document.",G(e,t));if(e[t]=="?"&&e[t+1]==">"){t++;break}else continue}return t}function Ht(e,t){if(e.length>t+5&&e[t+1]==="-"&&e[t+2]==="-"){for(t+=3;t<e.length;t++)if(e[t]==="-"&&e[t+1]==="-"&&e[t+2]===">"){t+=2;break}}else if(e.length>t+8&&e[t+1]==="D"&&e[t+2]==="O"&&e[t+3]==="C"&&e[t+4]==="T"&&e[t+5]==="Y"&&e[t+6]==="P"&&e[t+7]==="E"){let n=1;for(t+=8;t<e.length;t++)if(e[t]==="<")n++;else if(e[t]===">"&&(n--,n===0))break}else if(e.length>t+9&&e[t+1]==="["&&e[t+2]==="C"&&e[t+3]==="D"&&e[t+4]==="A"&&e[t+5]==="T"&&e[t+6]==="A"&&e[t+7]==="["){for(t+=8;t<e.length;t++)if(e[t]==="]"&&e[t+1]==="]"&&e[t+2]===">"){t+=2;break}}return t}var xn='"',pn="'";function gn(e,t){let n="",h="",a=!1;for(;t<e.length;t++){if(e[t]===xn||e[t]===pn)h===""?h=e[t]:h!==e[t]||(h="");else if(e[t]===">"&&h===""){a=!0;break}n+=e[t]}return h!==""?!1:{value:n,index:t,tagClosed:a}}var _n=new RegExp(`(\\s*)([^\\s=]+)(\\s*=)?(\\s*(['"])(([\\s\\S])*?)\\5)?`,"g");function bt(e,t){let n=et.getAllMatches(e,_n),h={};for(let a=0;a<n.length;a++){if(n[a][1].length===0)return M("InvalidAttr","Attribute '"+n[a][2]+"' has no space in starting.",Fe(n[a]));if(n[a][3]!==void 0&&n[a][4]===void 0)return M("InvalidAttr","Attribute '"+n[a][2]+"' is without value.",Fe(n[a]));if(n[a][3]===void 0&&!t.allowBooleanAttributes)return M("InvalidAttr","boolean attribute '"+n[a][2]+"' is not allowed.",Fe(n[a]));let c=n[a][2];if(!yn(c))return M("InvalidAttr","Attribute '"+c+"' is an invalid name.",Fe(n[a]));if(!h.hasOwnProperty(c))h[c]=1;else return M("InvalidAttr","Attribute '"+c+"' is repeated.",Fe(n[a]))}return!0}function vn(e,t){let n=/\d/;for(e[t]==="x"&&(t++,n=/[\da-fA-F]/);t<e.length;t++){if(e[t]===";")return t;if(!e[t].match(n))break}return-1}function wn(e,t){if(t++,e[t]===";")return-1;if(e[t]==="#")return t++,vn(e,t);let n=0;for(;t<e.length;t++,n++)if(!(e[t].match(/\w/)&&n<20)){if(e[t]===";")break;return-1}return t}function M(e,t,n){return{err:{code:e,msg:t,line:n.line||n,col:n.col}}}function yn(e){return et.isName(e)}function En(e){return et.isName(e)}function G(e,t){let n=e.substring(0,t).split(/\r?\n/);return{line:n.length,col:n[n.length-1].length+1}}function Fe(e){return e.startIndex+e[1].length}});var jt=q(rt=>{var zt={preserveOrder:!1,attributeNamePrefix:"@_",attributesGroupName:!1,textNodeName:"#text",ignoreAttributes:!0,removeNSPrefix:!1,allowBooleanAttributes:!1,parseTagValue:!0,parseAttributeValue:!1,trimValues:!0,cdataPropName:!1,numberParseOptions:{hex:!0,leadingZeros:!0,eNotation:!0},tagValueProcessor:function(e,t){return t},attributeValueProcessor:function(e,t){return t},stopNodes:[],alwaysCreateTextNode:!1,isArray:()=>!1,commentPropName:!1,unpairedTags:[],processEntities:!0,htmlEntities:!1,ignoreDeclaration:!1,ignorePiTags:!1,transformTagName:!1,transformAttributeName:!1,updateTag:function(e,t,n){return e}},mn=function(e){return Object.assign({},zt,e)};rt.buildOptions=mn;rt.defaultOptions=zt});var Xt=q((Ii,Kt)=>{"use strict";var nt=class{constructor(t){this.tagname=t,this.child=[],this[":@"]={}}add(t,n){t==="__proto__"&&(t="#__proto__"),this.child.push({[t]:n})}addChild(t){t.tagname==="__proto__"&&(t.tagname="#__proto__"),t[":@"]&&Object.keys(t[":@"]).length>0?this.child.push({[t.tagname]:t.child,":@":t[":@"]}):this.child.push({[t.tagname]:t.child})}};Kt.exports=nt});var Yt=q((Ni,Gt)=>{var Fn=Me();function In(e,t){let n={};if(e[t+3]==="O"&&e[t+4]==="C"&&e[t+5]==="T"&&e[t+6]==="Y"&&e[t+7]==="P"&&e[t+8]==="E"){t=t+9;let h=1,a=!1,c=!1,w="";for(;t<e.length;t++)if(e[t]==="<"&&!c){if(a&&Cn(e,t))t+=7,[entityName,val,t]=Nn(e,t+1),val.indexOf("&")===-1&&(n[Bn(entityName)]={regx:RegExp(`&${entityName};`,"g"),val});else if(a&&Tn(e,t))t+=8;else if(a&&Sn(e,t))t+=8;else if(a&&kn(e,t))t+=9;else if(An)c=!0;else throw new Error("Invalid DOCTYPE");h++,w=""}else if(e[t]===">"){if(c?e[t-1]==="-"&&e[t-2]==="-"&&(c=!1,h--):h--,h===0)break}else e[t]==="["?a=!0:w+=e[t];if(h!==0)throw new Error("Unclosed DOCTYPE")}else throw new Error("Invalid Tag instead of DOCTYPE");return{entities:n,i:t}}function Nn(e,t){let n="";for(;t<e.length&&e[t]!=="'"&&e[t]!=='"';t++)n+=e[t];if(n=n.trim(),n.indexOf(" ")!==-1)throw new Error("External entites are not supported");let h=e[t++],a="";for(;t<e.length&&e[t]!==h;t++)a+=e[t];return[n,a,t]}function An(e,t){return e[t+1]==="!"&&e[t+2]==="-"&&e[t+3]==="-"}function Cn(e,t){return e[t+1]==="!"&&e[t+2]==="E"&&e[t+3]==="N"&&e[t+4]==="T"&&e[t+5]==="I"&&e[t+6]==="T"&&e[t+7]==="Y"}function Tn(e,t){return e[t+1]==="!"&&e[t+2]==="E"&&e[t+3]==="L"&&e[t+4]==="E"&&e[t+5]==="M"&&e[t+6]==="E"&&e[t+7]==="N"&&e[t+8]==="T"}function Sn(e,t){return e[t+1]==="!"&&e[t+2]==="A"&&e[t+3]==="T"&&e[t+4]==="T"&&e[t+5]==="L"&&e[t+6]==="I"&&e[t+7]==="S"&&e[t+8]==="T"}function kn(e,t){return e[t+1]==="!"&&e[t+2]==="N"&&e[t+3]==="O"&&e[t+4]==="T"&&e[t+5]==="A"&&e[t+6]==="T"&&e[t+7]==="I"&&e[t+8]==="O"&&e[t+9]==="N"}function Bn(e){if(Fn.isName(e))return e;throw new Error(`Invalid entity name ${e}`)}Gt.exports=In});var Zt=q((Ai,qt)=>{var Pn=/^[-+]?0x[a-fA-F0-9]+$/,On=/^([\-\+])?(0*)(\.[0-9]+([eE]\-?[0-9]+)?|[0-9]+(\.[0-9]+([eE]\-?[0-9]+)?)?)$/;!Number.parseInt&&window.parseInt&&(Number.parseInt=window.parseInt);!Number.parseFloat&&window.parseFloat&&(Number.parseFloat=window.parseFloat);var Vn={hex:!0,leadingZeros:!0,decimalPoint:".",eNotation:!0};function Rn(e,t={}){if(t=Object.assign({},Vn,t),!e||typeof e!="string")return e;let n=e.trim();if(t.skipLike!==void 0&&t.skipLike.test(n))return e;if(t.hex&&Pn.test(n))return Number.parseInt(n,16);{let h=On.exec(n);if(h){let a=h[1],c=h[2],w=Ln(h[3]),v=h[4]||h[6];if(!t.leadingZeros&&c.length>0&&a&&n[2]!==".")return e;if(!t.leadingZeros&&c.length>0&&!a&&n[1]!==".")return e;{let l=Number(n),y=""+l;return y.search(/[eE]/)!==-1||v?t.eNotation?l:e:n.indexOf(".")!==-1?y==="0"&&w===""||y===w||a&&y==="-"+w?l:e:c?w===y||a+w===y?l:e:n===y||n===a+y?l:e}}else return e}}function Ln(e){return e&&e.indexOf(".")!==-1&&(e=e.replace(/0+$/,""),e==="."?e="0":e[0]==="."?e="0"+e:e[e.length-1]==="."&&(e=e.substr(0,e.length-1))),e}qt.exports=Rn});var Qt=q((Ci,Wt)=>{"use strict";var Jt=Me(),Ie=Xt(),Un=Yt(),Mn=Zt(),it=class{constructor(t){this.options=t,this.currentNode=null,this.tagsNodeStack=[],this.docTypeEntities={},this.lastEntities={apos:{regex:/&(apos|#39|#x27);/g,val:"'"},gt:{regex:/&(gt|#62|#x3E);/g,val:">"},lt:{regex:/&(lt|#60|#x3C);/g,val:"<"},quot:{regex:/&(quot|#34|#x22);/g,val:'"'}},this.ampEntity={regex:/&(amp|#38|#x26);/g,val:"&"},this.htmlEntities={space:{regex:/&(nbsp|#160);/g,val:" "},cent:{regex:/&(cent|#162);/g,val:"\xA2"},pound:{regex:/&(pound|#163);/g,val:"\xA3"},yen:{regex:/&(yen|#165);/g,val:"\xA5"},euro:{regex:/&(euro|#8364);/g,val:"\u20AC"},copyright:{regex:/&(copy|#169);/g,val:"\xA9"},reg:{regex:/&(reg|#174);/g,val:"\xAE"},inr:{regex:/&(inr|#8377);/g,val:"\u20B9"},num_dec:{regex:/&#([0-9]{1,7});/g,val:(n,h)=>String.fromCharCode(Number.parseInt(h,10))},num_hex:{regex:/&#x([0-9a-fA-F]{1,6});/g,val:(n,h)=>String.fromCharCode(Number.parseInt(h,16))}},this.addExternalEntities=Hn,this.parseXml=Kn,this.parseTextData=bn,this.resolveNameSpace=$n,this.buildAttributesMap=jn,this.isItStopNode=qn,this.replaceEntitiesValue=Gn,this.readStopNodeData=Jn,this.saveTextToParentTag=Yn,this.addChild=Xn}};function Hn(e){let t=Object.keys(e);for(let n=0;n<t.length;n++){let h=t[n];this.lastEntities[h]={regex:new RegExp("&"+h+";","g"),val:e[h]}}}function bn(e,t,n,h,a,c,w){if(e!==void 0&&(this.options.trimValues&&!h&&(e=e.trim()),e.length>0)){w||(e=this.replaceEntitiesValue(e));let v=this.options.tagValueProcessor(t,e,n,a,c);return v==null?e:typeof v!=typeof e||v!==e?v:this.options.trimValues?at(e,this.options.parseTagValue,this.options.numberParseOptions):e.trim()===e?at(e,this.options.parseTagValue,this.options.numberParseOptions):e}}function $n(e){if(this.options.removeNSPrefix){let t=e.split(":"),n=e.charAt(0)==="/"?"/":"";if(t[0]==="xmlns")return"";t.length===2&&(e=n+t[1])}return e}var zn=new RegExp(`([^\\s=]+)\\s*(=\\s*(['"])([\\s\\S]*?)\\3)?`,"gm");function jn(e,t,n){if(!this.options.ignoreAttributes&&typeof e=="string"){let h=Jt.getAllMatches(e,zn),a=h.length,c={};for(let w=0;w<a;w++){let v=this.resolveNameSpace(h[w][1]),l=h[w][4],y=this.options.attributeNamePrefix+v;if(v.length)if(this.options.transformAttributeName&&(y=this.options.transformAttributeName(y)),y==="__proto__"&&(y="#__proto__"),l!==void 0){this.options.trimValues&&(l=l.trim()),l=this.replaceEntitiesValue(l);let N=this.options.attributeValueProcessor(v,l,t);N==null?c[y]=l:typeof N!=typeof l||N!==l?c[y]=N:c[y]=at(l,this.options.parseAttributeValue,this.options.numberParseOptions)}else this.options.allowBooleanAttributes&&(c[y]=!0)}if(!Object.keys(c).length)return;if(this.options.attributesGroupName){let w={};return w[this.options.attributesGroupName]=c,w}return c}}var Kn=function(e){e=e.replace(/\r\n?/g,`
`);let t=new Ie("!xml"),n=t,h="",a="";for(let c=0;c<e.length;c++)if(e[c]==="<")if(e[c+1]==="/"){let v=oe(e,">",c,"Closing Tag is not closed."),l=e.substring(c+2,v).trim();if(this.options.removeNSPrefix){let k=l.indexOf(":");k!==-1&&(l=l.substr(k+1))}this.options.transformTagName&&(l=this.options.transformTagName(l)),n&&(h=this.saveTextToParentTag(h,n,a));let y=a.substring(a.lastIndexOf(".")+1);if(l&&this.options.unpairedTags.indexOf(l)!==-1)throw new Error(`Unpaired tag can not be used as closing tag: </${l}>`);let N=0;y&&this.options.unpairedTags.indexOf(y)!==-1?(N=a.lastIndexOf(".",a.lastIndexOf(".")-1),this.tagsNodeStack.pop()):N=a.lastIndexOf("."),a=a.substring(0,N),n=this.tagsNodeStack.pop(),h="",c=v}else if(e[c+1]==="?"){let v=st(e,c,!1,"?>");if(!v)throw new Error("Pi Tag is not closed.");if(h=this.saveTextToParentTag(h,n,a),!(this.options.ignoreDeclaration&&v.tagName==="?xml"||this.options.ignorePiTags)){let l=new Ie(v.tagName);l.add(this.options.textNodeName,""),v.tagName!==v.tagExp&&v.attrExpPresent&&(l[":@"]=this.buildAttributesMap(v.tagExp,a,v.tagName)),this.addChild(n,l,a)}c=v.closeIndex+1}else if(e.substr(c+1,3)==="!--"){let v=oe(e,"-->",c+4,"Comment is not closed.");if(this.options.commentPropName){let l=e.substring(c+4,v-2);h=this.saveTextToParentTag(h,n,a),n.add(this.options.commentPropName,[{[this.options.textNodeName]:l}])}c=v}else if(e.substr(c+1,2)==="!D"){let v=Un(e,c);this.docTypeEntities=v.entities,c=v.i}else if(e.substr(c+1,2)==="!["){let v=oe(e,"]]>",c,"CDATA is not closed.")-2,l=e.substring(c+9,v);h=this.saveTextToParentTag(h,n,a);let y=this.parseTextData(l,n.tagname,a,!0,!1,!0,!0);y==null&&(y=""),this.options.cdataPropName?n.add(this.options.cdataPropName,[{[this.options.textNodeName]:l}]):n.add(this.options.textNodeName,y),c=v+2}else{let v=st(e,c,this.options.removeNSPrefix),l=v.tagName,y=v.rawTagName,N=v.tagExp,k=v.attrExpPresent,R=v.closeIndex;this.options.transformTagName&&(l=this.options.transformTagName(l)),n&&h&&n.tagname!=="!xml"&&(h=this.saveTextToParentTag(h,n,a,!1));let L=n;if(L&&this.options.unpairedTags.indexOf(L.tagname)!==-1&&(n=this.tagsNodeStack.pop(),a=a.substring(0,a.lastIndexOf("."))),l!==t.tagname&&(a+=a?"."+l:l),this.isItStopNode(this.options.stopNodes,a,l)){let P="";if(N.length>0&&N.lastIndexOf("/")===N.length-1)l[l.length-1]==="/"?(l=l.substr(0,l.length-1),a=a.substr(0,a.length-1),N=l):N=N.substr(0,N.length-1),c=v.closeIndex;else if(this.options.unpairedTags.indexOf(l)!==-1)c=v.closeIndex;else{let j=this.readStopNodeData(e,y,R+1);if(!j)throw new Error(`Unexpected end of ${y}`);c=j.i,P=j.tagContent}let z=new Ie(l);l!==N&&k&&(z[":@"]=this.buildAttributesMap(N,a,l)),P&&(P=this.parseTextData(P,l,a,!0,k,!0,!0)),a=a.substr(0,a.lastIndexOf(".")),z.add(this.options.textNodeName,P),this.addChild(n,z,a)}else{if(N.length>0&&N.lastIndexOf("/")===N.length-1){l[l.length-1]==="/"?(l=l.substr(0,l.length-1),a=a.substr(0,a.length-1),N=l):N=N.substr(0,N.length-1),this.options.transformTagName&&(l=this.options.transformTagName(l));let P=new Ie(l);l!==N&&k&&(P[":@"]=this.buildAttributesMap(N,a,l)),this.addChild(n,P,a),a=a.substr(0,a.lastIndexOf("."))}else{let P=new Ie(l);this.tagsNodeStack.push(n),l!==N&&k&&(P[":@"]=this.buildAttributesMap(N,a,l)),this.addChild(n,P,a),n=P}h="",c=R}}else h+=e[c];return t.child};function Xn(e,t,n){let h=this.options.updateTag(t.tagname,n,t[":@"]);h===!1||(typeof h=="string"&&(t.tagname=h),e.addChild(t))}var Gn=function(e){if(this.options.processEntities){for(let t in this.docTypeEntities){let n=this.docTypeEntities[t];e=e.replace(n.regx,n.val)}for(let t in this.lastEntities){let n=this.lastEntities[t];e=e.replace(n.regex,n.val)}if(this.options.htmlEntities)for(let t in this.htmlEntities){let n=this.htmlEntities[t];e=e.replace(n.regex,n.val)}e=e.replace(this.ampEntity.regex,this.ampEntity.val)}return e};function Yn(e,t,n,h){return e&&(h===void 0&&(h=Object.keys(t.child).length===0),e=this.parseTextData(e,t.tagname,n,!1,t[":@"]?Object.keys(t[":@"]).length!==0:!1,h),e!==void 0&&e!==""&&t.add(this.options.textNodeName,e),e=""),e}function qn(e,t,n){let h="*."+n;for(let a in e){let c=e[a];if(h===c||t===c)return!0}return!1}function Zn(e,t,n=">"){let h,a="";for(let c=t;c<e.length;c++){let w=e[c];if(h)w===h&&(h="");else if(w==='"'||w==="'")h=w;else if(w===n[0])if(n[1]){if(e[c+1]===n[1])return{data:a,index:c}}else return{data:a,index:c};else w==="	"&&(w=" ");a+=w}}function oe(e,t,n,h){let a=e.indexOf(t,n);if(a===-1)throw new Error(h);return a+t.length-1}function st(e,t,n,h=">"){let a=Zn(e,t+1,h);if(!a)return;let c=a.data,w=a.index,v=c.search(/\s/),l=c,y=!0;v!==-1&&(l=c.substring(0,v),c=c.substring(v+1).trimStart());let N=l;if(n){let k=l.indexOf(":");k!==-1&&(l=l.substr(k+1),y=l!==a.data.substr(k+1))}return{tagName:l,tagExp:c,closeIndex:w,attrExpPresent:y,rawTagName:N}}function Jn(e,t,n){let h=n,a=1;for(;n<e.length;n++)if(e[n]==="<")if(e[n+1]==="/"){let c=oe(e,">",n,`${t} is not closed`);if(e.substring(n+2,c).trim()===t&&(a--,a===0))return{tagContent:e.substring(h,n),i:c};n=c}else if(e[n+1]==="?")n=oe(e,"?>",n+1,"StopNode is not closed.");else if(e.substr(n+1,3)==="!--")n=oe(e,"-->",n+3,"StopNode is not closed.");else if(e.substr(n+1,2)==="![")n=oe(e,"]]>",n,"StopNode is not closed.")-2;else{let c=st(e,n,">");c&&((c&&c.tagName)===t&&c.tagExp[c.tagExp.length-1]!=="/"&&a++,n=c.closeIndex)}}function at(e,t,n){if(t&&typeof e=="string"){let h=e.trim();return h==="true"?!0:h==="false"?!1:Mn(e,n)}else return Jt.isExist(e)?e:""}Wt.exports=it});var tr=q(er=>{"use strict";function Wn(e,t){return Dt(e,t)}function Dt(e,t,n){let h,a={};for(let c=0;c<e.length;c++){let w=e[c],v=Qn(w),l="";if(n===void 0?l=v:l=n+"."+v,v===t.textNodeName)h===void 0?h=w[v]:h+=""+w[v];else{if(v===void 0)continue;if(w[v]){let y=Dt(w[v],t,l),N=ei(y,t);w[":@"]?Dn(y,w[":@"],l,t):Object.keys(y).length===1&&y[t.textNodeName]!==void 0&&!t.alwaysCreateTextNode?y=y[t.textNodeName]:Object.keys(y).length===0&&(t.alwaysCreateTextNode?y[t.textNodeName]="":y=""),a[v]!==void 0&&a.hasOwnProperty(v)?(Array.isArray(a[v])||(a[v]=[a[v]]),a[v].push(y)):t.isArray(v,l,N)?a[v]=[y]:a[v]=y}}}return typeof h=="string"?h.length>0&&(a[t.textNodeName]=h):h!==void 0&&(a[t.textNodeName]=h),a}function Qn(e){let t=Object.keys(e);for(let n=0;n<t.length;n++){let h=t[n];if(h!==":@")return h}}function Dn(e,t,n,h){if(t){let a=Object.keys(t),c=a.length;for(let w=0;w<c;w++){let v=a[w];h.isArray(v,n+"."+v,!0,!0)?e[v]=[t[v]]:e[v]=t[v]}}}function ei(e,t){let{textNodeName:n}=t,h=Object.keys(e).length;return!!(h===0||h===1&&(e[n]||typeof e[n]=="boolean"||e[n]===0))}er.prettify=Wn});var nr=q((Si,rr)=>{var{buildOptions:ti}=jt(),ri=Qt(),{prettify:ni}=tr(),ii=tt(),ft=class{constructor(t){this.externalEntities={},this.options=ti(t)}parse(t,n){if(typeof t!="string")if(t.toString)t=t.toString();else throw new Error("XML data is accepted in String or Bytes[] form.");if(n){n===!0&&(n={});let c=ii.validate(t,n);if(c!==!0)throw Error(`${c.err.msg}:${c.err.line}:${c.err.col}`)}let h=new ri(this.options);h.addExternalEntities(this.externalEntities);let a=h.parseXml(t);return this.options.preserveOrder||a===void 0?a:ni(a,this.options)}addEntity(t,n){if(n.indexOf("&")!==-1)throw new Error("Entity value can't have '&'");if(t.indexOf("&")!==-1||t.indexOf(";")!==-1)throw new Error("An entity must be set without '&' and ';'. Eg. use '#xD' for '&#xD;'");if(n==="&")throw new Error("An entity with value '&' is not permitted");this.externalEntities[t]=n}};rr.exports=ft});var or=q((ki,fr)=>{var si=`
`;function ai(e,t){let n="";return t.format&&t.indentBy.length>0&&(n=si),sr(e,t,"",n)}function sr(e,t,n,h){let a="",c=!1;for(let w=0;w<e.length;w++){let v=e[w],l=fi(v);if(l===void 0)continue;let y="";if(n.length===0?y=l:y=`${n}.${l}`,l===t.textNodeName){let P=v[l];oi(y,t)||(P=t.tagValueProcessor(l,P),P=ar(P,t)),c&&(a+=h),a+=P,c=!1;continue}else if(l===t.cdataPropName){c&&(a+=h),a+=`<![CDATA[${v[l][0][t.textNodeName]}]]>`,c=!1;continue}else if(l===t.commentPropName){a+=h+`<!--${v[l][0][t.textNodeName]}-->`,c=!0;continue}else if(l[0]==="?"){let P=ir(v[":@"],t),z=l==="?xml"?"":h,j=v[l][0][t.textNodeName];j=j.length!==0?" "+j:"",a+=z+`<${l}${j}${P}?>`,c=!0;continue}let N=h;N!==""&&(N+=t.indentBy);let k=ir(v[":@"],t),R=h+`<${l}${k}`,L=sr(v[l],t,y,N);t.unpairedTags.indexOf(l)!==-1?t.suppressUnpairedNode?a+=R+">":a+=R+"/>":(!L||L.length===0)&&t.suppressEmptyNode?a+=R+"/>":L&&L.endsWith(">")?a+=R+`>${L}${h}</${l}>`:(a+=R+">",L&&h!==""&&(L.includes("/>")||L.includes("</"))?a+=h+t.indentBy+L+h:a+=L,a+=`</${l}>`),c=!0}return a}function fi(e){let t=Object.keys(e);for(let n=0;n<t.length;n++){let h=t[n];if(e.hasOwnProperty(h)&&h!==":@")return h}}function ir(e,t){let n="";if(e&&!t.ignoreAttributes)for(let h in e){if(!e.hasOwnProperty(h))continue;let a=t.attributeValueProcessor(h,e[h]);a=ar(a,t),a===!0&&t.suppressBooleanAttributes?n+=` ${h.substr(t.attributeNamePrefix.length)}`:n+=` ${h.substr(t.attributeNamePrefix.length)}="${a}"`}return n}function oi(e,t){e=e.substr(0,e.length-t.textNodeName.length-1);let n=e.substr(e.lastIndexOf(".")+1);for(let h in t.stopNodes)if(t.stopNodes[h]===e||t.stopNodes[h]==="*."+n)return!0;return!1}function ar(e,t){if(e&&e.length>0&&t.processEntities)for(let n=0;n<t.entities.length;n++){let h=t.entities[n];e=e.replace(h.regex,h.val)}return e}fr.exports=ai});var hr=q((Bi,ur)=>{"use strict";var ui=or(),hi={attributeNamePrefix:"@_",attributesGroupName:!1,textNodeName:"#text",ignoreAttributes:!0,cdataPropName:!1,format:!1,indentBy:"  ",suppressEmptyNode:!1,suppressUnpairedNode:!0,suppressBooleanAttributes:!0,tagValueProcessor:function(e,t){return t},attributeValueProcessor:function(e,t){return t},preserveOrder:!1,commentPropName:!1,unpairedTags:[],entities:[{regex:new RegExp("&","g"),val:"&amp;"},{regex:new RegExp(">","g"),val:"&gt;"},{regex:new RegExp("<","g"),val:"&lt;"},{regex:new RegExp("'","g"),val:"&apos;"},{regex:new RegExp('"',"g"),val:"&quot;"}],processEntities:!0,stopNodes:[],oneListGroup:!1};function se(e){this.options=Object.assign({},hi,e),this.options.ignoreAttributes||this.options.attributesGroupName?this.isAttribute=function(){return!1}:(this.attrPrefixLen=this.options.attributeNamePrefix.length,this.isAttribute=di),this.processTextOrObjNode=ci,this.options.format?(this.indentate=li,this.tagEndChar=`>
`,this.newLine=`
`):(this.indentate=function(){return""},this.tagEndChar=">",this.newLine="")}se.prototype.build=function(e){return this.options.preserveOrder?ui(e,this.options):(Array.isArray(e)&&this.options.arrayNodeName&&this.options.arrayNodeName.length>1&&(e={[this.options.arrayNodeName]:e}),this.j2x(e,0).val)};se.prototype.j2x=function(e,t){let n="",h="";for(let a in e)if(Object.prototype.hasOwnProperty.call(e,a))if(typeof e[a]>"u")this.isAttribute(a)&&(h+="");else if(e[a]===null)this.isAttribute(a)?h+="":a[0]==="?"?h+=this.indentate(t)+"<"+a+"?"+this.tagEndChar:h+=this.indentate(t)+"<"+a+"/"+this.tagEndChar;else if(e[a]instanceof Date)h+=this.buildTextValNode(e[a],a,"",t);else if(typeof e[a]!="object"){let c=this.isAttribute(a);if(c)n+=this.buildAttrPairStr(c,""+e[a]);else if(a===this.options.textNodeName){let w=this.options.tagValueProcessor(a,""+e[a]);h+=this.replaceEntitiesValue(w)}else h+=this.buildTextValNode(e[a],a,"",t)}else if(Array.isArray(e[a])){let c=e[a].length,w="",v="";for(let l=0;l<c;l++){let y=e[a][l];if(!(typeof y>"u"))if(y===null)a[0]==="?"?h+=this.indentate(t)+"<"+a+"?"+this.tagEndChar:h+=this.indentate(t)+"<"+a+"/"+this.tagEndChar;else if(typeof y=="object")if(this.options.oneListGroup){let N=this.j2x(y,t+1);w+=N.val,this.options.attributesGroupName&&y.hasOwnProperty(this.options.attributesGroupName)&&(v+=N.attrStr)}else w+=this.processTextOrObjNode(y,a,t);else if(this.options.oneListGroup){let N=this.options.tagValueProcessor(a,y);N=this.replaceEntitiesValue(N),w+=N}else w+=this.buildTextValNode(y,a,"",t)}this.options.oneListGroup&&(w=this.buildObjectNode(w,a,v,t)),h+=w}else if(this.options.attributesGroupName&&a===this.options.attributesGroupName){let c=Object.keys(e[a]),w=c.length;for(let v=0;v<w;v++)n+=this.buildAttrPairStr(c[v],""+e[a][c[v]])}else h+=this.processTextOrObjNode(e[a],a,t);return{attrStr:n,val:h}};se.prototype.buildAttrPairStr=function(e,t){return t=this.options.attributeValueProcessor(e,""+t),t=this.replaceEntitiesValue(t),this.options.suppressBooleanAttributes&&t==="true"?" "+e:" "+e+'="'+t+'"'};function ci(e,t,n){let h=this.j2x(e,n+1);return e[this.options.textNodeName]!==void 0&&Object.keys(e).length===1?this.buildTextValNode(e[this.options.textNodeName],t,h.attrStr,n):this.buildObjectNode(h.val,t,h.attrStr,n)}se.prototype.buildObjectNode=function(e,t,n,h){if(e==="")return t[0]==="?"?this.indentate(h)+"<"+t+n+"?"+this.tagEndChar:this.indentate(h)+"<"+t+n+this.closeTag(t)+this.tagEndChar;{let a="</"+t+this.tagEndChar,c="";return t[0]==="?"&&(c="?",a=""),(n||n==="")&&e.indexOf("<")===-1?this.indentate(h)+"<"+t+n+c+">"+e+a:this.options.commentPropName!==!1&&t===this.options.commentPropName&&c.length===0?this.indentate(h)+`<!--${e}-->`+this.newLine:this.indentate(h)+"<"+t+n+c+this.tagEndChar+e+this.indentate(h)+a}};se.prototype.closeTag=function(e){let t="";return this.options.unpairedTags.indexOf(e)!==-1?this.options.suppressUnpairedNode||(t="/"):this.options.suppressEmptyNode?t="/":t=`></${e}`,t};se.prototype.buildTextValNode=function(e,t,n,h){if(this.options.cdataPropName!==!1&&t===this.options.cdataPropName)return this.indentate(h)+`<![CDATA[${e}]]>`+this.newLine;if(this.options.commentPropName!==!1&&t===this.options.commentPropName)return this.indentate(h)+`<!--${e}-->`+this.newLine;if(t[0]==="?")return this.indentate(h)+"<"+t+n+"?"+this.tagEndChar;{let a=this.options.tagValueProcessor(t,e);return a=this.replaceEntitiesValue(a),a===""?this.indentate(h)+"<"+t+n+this.closeTag(t)+this.tagEndChar:this.indentate(h)+"<"+t+n+">"+a+"</"+t+this.tagEndChar}};se.prototype.replaceEntitiesValue=function(e){if(e&&e.length>0&&this.options.processEntities)for(let t=0;t<this.options.entities.length;t++){let n=this.options.entities[t];e=e.replace(n.regex,n.val)}return e};function li(e){return this.options.indentBy.repeat(e)}function di(e){return e.startsWith(this.options.attributeNamePrefix)&&e!==this.options.textNodeName?e.substr(this.attrPrefixLen):!1}ur.exports=se});var lr=q((Pi,cr)=>{"use strict";var xi=tt(),pi=nr(),gi=hr();cr.exports={XMLParser:pi,XMLValidator:xi,XMLBuilder:gi}});var _i={};Qr(_i,{XLSX_Cryptor:()=>ot});module.exports=Dr(_i);var D=require("crypto"),J=Ft(Vt());var Ue=require("crypto"),Le=class{hmac(t,n,...h){let a=(0,Ue.createHmac)(t.toLowerCase(),n);return a.update(Buffer.concat(h)),a.digest()}createIV(t,n,h,a){typeof a=="number"&&(a=this.createUInt32LEBuffer(a));let c=this.hash(t,n,a);if(c.length<h){let w=Buffer.alloc(h,54);c.copy(w),c=w}else c.length>h&&(c=c.subarray(0,h));return c}createUInt32LEBuffer(t,n=4){let h=Buffer.alloc(n);return h.writeUInt32LE(t,0),h}hash(t,...n){let h=(0,Ue.createHash)(t);return h.update(Buffer.concat(n)),h.digest()}};var dr=Ft(lr()),He=class{createEncXml(t,n,h){let a={ignoreAttributes:!1,format:!0,suppressEmptyNode:!0};return new dr.XMLBuilder(a).build({encryption:{"@_xmlns":"http://schemas.microsoft.com/office/2006/encryption","@_xmlns:p":"http://schemas.microsoft.com/office/2006/keyEncryptor/password","@_xmlns:c":"http://schemas.microsoft.com/office/2006/keyEncryptor/certificate",keyData:{"@_saltSize":t.salt.length,"@_blockSize":t.blockSize,"@_keyBits":t.keyBits,"@_hashSize":t.hashSize,"@_cipherAlgorithm":t.cipherAlgorithm,"@_cipherChaining":t.cipherChaining,"@_hashAlgorithm":t.hashAlgorithm,"@_saltValue":t.salt.toString("base64")},dataIntegrity:{"@_encryptedHmacKey":h.encryptedHmacKey.toString("base64"),"@_encryptedHmacValue":h.encryptedHmacValue.toString("base64")},keyEncryptors:{keyEncryptor:{"@_uri":"http://schemas.microsoft.com/office/2006/keyEncryptor/password","p:encryptedKey":{"@_spinCount":n.spinCount,"@_saltSize":n.salt.length,"@_blockSize":n.blockSize,"@_keyBits":n.keyBits,"@_hashSize":n.hashSize,"@_cipherAlgorithm":n.cipherAlgorithm,"@_cipherChaining":n.cipherChaining,"@_hashAlgorithm":n.hashAlgorithm,"@_saltValue":n.salt.toString("base64"),"@_encryptedVerifierHashInput":n.encryptedVerifierHashInput.toString("base64"),"@_encryptedVerifierHashValue":n.encryptedVerifierHashValue.toString("base64"),"@_encryptedKeyValue":n.encryptedKeyValue.toString("base64")}}}}})}};var xr=Buffer.from([4,0,4,0,64,0,0,0]),xe={KEY:Buffer.from([20,110,11,231,171,172,208,214]),INTEGRITY:{HMAC_KEY:Buffer.from([95,178,173,1,12,185,225,246]),HMAC_VALUE:Buffer.from([160,103,127,2,178,44,132,51])},VERIFIER_HASH:{INPUT:Buffer.from([254,167,210,118,59,75,158,121]),VALUE:Buffer.from([215,170,15,109,48,97,52,78])}},pr=Buffer.from([60,0,0,0,77,0,105,0,99,0,114,0,111,0,115,0,111,0,102,0,116,0,46,0,67,0,111,0,110,0,116,0,97,0,105,0,110,0,101,0,114,0,46,0,68,0,97,0,116,0,97,0,83,0,112,0,97,0,99,0,101,0,115,0,1,0,0,0,1,0,0,0,1,0,0,0]),gr=Buffer.from([88,0,0,0,1,0,0,0,76,0,0,0,123,0,70,0,70,0,57,0,65,0,51,0,70,0,48,0,51,0,45,0,53,0,54,0,69,0,70,0,45,0,52,0,54,0,49,0,51,0,45,0,66,0,68,0,68,0,53,0,45,0,53,0,65,0,52,0,49,0,67,0,49,0,68,0,48,0,55,0,50,0,52,0,54,0,125,0,78,0,0,0,77,0,105,0,99,0,114,0,111,0,115,0,111,0,102,0,116,0,46,0,67,0,111,0,110,0,116,0,97,0,105,0,110,0,101,0,114,0,46,0,69,0,110,0,99,0,114,0,121,0,112,0,116,0,105,0,111,0,110,0,84,0,114,0,97,0,110,0,115,0,102,0,111,0,114,0,109,0,0,0,1,0,0,0,1,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,4,0,0,0]),_r=Buffer.from([8,0,0,0,1,0,0,0,104,0,0,0,1,0,0,0,0,0,0,0,32,0,0,0,69,0,110,0,99,0,114,0,121,0,112,0,116,0,101,0,100,0,80,0,97,0,99,0,107,0,97,0,103,0,101,0,50,0,0,0,83,0,116,0,114,0,111,0,110,0,103,0,69,0,110,0,99,0,114,0,121,0,112,0,116,0,105,0,111,0,110,0,68,0,97,0,116,0,97,0,83,0,112,0,97,0,99,0,101,0,0,0]),vr=Buffer.from([8,0,0,0,1,0,0,0,50,0,0,0,83,0,116,0,114,0,111,0,110,0,103,0,69,0,110,0,99,0,114,0,121,0,112,0,116,0,105,0,111,0,110,0,84,0,114,0,97,0,110,0,115,0,102,0,111,0,114,0,109,0,0,0]);var ot=class{constructor(){this.packageKey=(0,D.randomBytes)(32);this.iChunkSize=4096;this.iOffset=8;this.objEncInfo={package:{cipherAlgorithm:"AES",cipherChaining:"ChainingModeCBC",salt:(0,D.randomBytes)(16),hashAlgorithm:"SHA512",hashSize:64,blockSize:16,keyBits:this.packageKey.length*8},key:{cipherAlgorithm:"AES",cipherChaining:"ChainingModeCBC",salt:(0,D.randomBytes)(16),hashAlgorithm:"SHA512",hashSize:64,blockSize:16,spinCount:500,keyBits:256,encryptedKeyValue:void 0,encryptedVerifierHashInput:void 0,encryptedVerifierHashValue:void 0},dataIntegrity:{encryptedHmacKey:void 0,encryptedHmacValue:void 0}};this.cryptoTool=new Le,this.xmlTool=new He}encrypt({data:t,password:n}){let h=J.utils.cfb_new(),a=this.createEncryptedPackage(t);J.utils.cfb_add(h,"EncryptedPackage",a);let c=(0,D.randomBytes)(16);this.objEncInfo.key.encryptedVerifierHashInput=this.createEncryptedVerifierHashInput(n,c),this.objEncInfo.key.encryptedVerifierHashValue=this.createEncryptedVerifierHashValue(n,c),this.objEncInfo.key.encryptedKeyValue=this.createEncryptedKeyValue(n);let w=(0,D.randomBytes)(64);this.objEncInfo.dataIntegrity={encryptedHmacKey:this.createEncryptedHmacKey(w),encryptedHmacValue:this.createEncryptedHmacValue(w,a)};let v=this.xmlTool.createEncXml(this.objEncInfo.package,this.objEncInfo.key,this.objEncInfo.dataIntegrity),l=Buffer.concat([xr,Buffer.from(v,"utf8")]);J.utils.cfb_add(h,"EncryptionInfo",l),J.utils.cfb_add(h,"DataSpaces/",null),J.utils.cfb_add(h,"DataSpaces/DataSpaceMap",_r),J.utils.cfb_add(h,"DataSpaces/Version",pr),J.utils.cfb_add(h,"DataSpaces/DataSpaceInfo/StrongEncryptionDataSpace",vr),J.utils.cfb_add(h,"DataSpaces/TransformInfo/StrongEncryptionTransform/Primary",gr);let y=(0,J.write)(h);return Buffer.isBuffer(y)?y:Buffer.from(y)}crypt(t,n,h,a,c,w){let v=`${n.toLowerCase()}-${a.length*8}`;if(h==="ChainingModeCBC")v+="-cbc";else throw new Error(`Unknown cipher chaining: ${h}`);let l=t==="encrypt"?(0,D.createCipheriv)(v,a,c):(0,D.createDecipheriv)(v,a,c);l.setAutoPadding(!1);let y=l.update(w);return y=Buffer.concat([y,l.final()]),y}cryptPackage(t,n,h,a,c,w,v,l){let y=[],N=t==="encrypt"?0:this.iOffset,k=0,R=0,L=0;for(;L<l.length;){R=L,L=R+this.iChunkSize,L>l.length&&(L=l.length);let z=l.subarray(R+N,L+N),j=z.length%c;j&&(z=Buffer.concat([z,Buffer.alloc(c-j)]));let pe=this.cryptoTool.createIV(a,w,c,k),ge=this.crypt(t,n,h,v,pe,z);y.push(ge),k++}let P=Buffer.concat(y);if(t==="encrypt")P=Buffer.concat([this.cryptoTool.createUInt32LEBuffer(l.length,this.iOffset),P]);else{let z=l.readUInt32LE(0);P=P.subarray(0,z)}return P}convertPasswordToKey(t,n,h,a,c,w){let v=Buffer.from(t,"utf16le"),l=this.cryptoTool.hash(n,h,v);for(let N=0;N<a;N++){let k=this.cryptoTool.createUInt32LEBuffer(N);l=this.cryptoTool.hash(n,k,l)}l=this.cryptoTool.hash(n,l,w);let y=c/8;if(l.length<y){let N=Buffer.alloc(y,54);l.copy(N),l=N}else l.length>y&&(l=l.subarray(0,y));return l}createEncryptedPackage(t){return this.cryptPackage("encrypt",this.objEncInfo.package.cipherAlgorithm,this.objEncInfo.package.cipherChaining,this.objEncInfo.package.hashAlgorithm,this.objEncInfo.package.blockSize,this.objEncInfo.package.salt,this.packageKey,t)}createEncryptedHmacKey(t){let n=this.cryptoTool.createIV(this.objEncInfo.package.hashAlgorithm,this.objEncInfo.package.salt,this.objEncInfo.package.blockSize,xe.INTEGRITY.HMAC_KEY);return this.crypt("encrypt",this.objEncInfo.package.cipherAlgorithm,this.objEncInfo.package.cipherChaining,this.packageKey,n,t)}createEncryptedHmacValue(t,n){let h=this.cryptoTool.hmac(this.objEncInfo.package.hashAlgorithm,t,n),a=this.cryptoTool.createIV(this.objEncInfo.package.hashAlgorithm,this.objEncInfo.package.salt,this.objEncInfo.package.blockSize,xe.INTEGRITY.HMAC_VALUE);return this.crypt("encrypt",this.objEncInfo.package.cipherAlgorithm,this.objEncInfo.package.cipherChaining,this.packageKey,a,h)}createEncryptedKeyValue(t){let n=this.convertPasswordToKey(t,this.objEncInfo.key.hashAlgorithm,this.objEncInfo.key.salt,this.objEncInfo.key.spinCount,this.objEncInfo.key.keyBits,xe.KEY);return this.crypt("encrypt",this.objEncInfo.key.cipherAlgorithm,this.objEncInfo.key.cipherChaining,n,this.objEncInfo.key.salt,this.packageKey)}createEncryptedVerifierHashInput(t,n){let h=this.convertPasswordToKey(t,this.objEncInfo.key.hashAlgorithm,this.objEncInfo.key.salt,this.objEncInfo.key.spinCount,this.objEncInfo.key.keyBits,xe.VERIFIER_HASH.INPUT);return this.crypt("encrypt",this.objEncInfo.key.cipherAlgorithm,this.objEncInfo.key.cipherChaining,h,this.objEncInfo.key.salt,n)}createEncryptedVerifierHashValue(t,n){let h=this.convertPasswordToKey(t,this.objEncInfo.key.hashAlgorithm,this.objEncInfo.key.salt,this.objEncInfo.key.spinCount,this.objEncInfo.key.keyBits,xe.VERIFIER_HASH.VALUE);return this.crypt("encrypt",this.objEncInfo.key.cipherAlgorithm,this.objEncInfo.key.cipherChaining,h,this.objEncInfo.key.salt,this.cryptoTool.hash(this.objEncInfo.key.hashAlgorithm,n))}};0&&(module.exports={XLSX_Cryptor});
/*! Bundled license information:

cfb/cfb.js:
  (*! crc32.js (C) 2014-present SheetJS -- http://sheetjs.com *)
*/
